import requests
import pandas as pd
from bs4 import BeautifulSoup as bs

# Basic settings
DATE = '202001' # format : YYYYMM (the oldest date: 201506)
view_state = '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5bmj5biC5aC05Z6LLEFDMTIu5ZyL5YWn5oqV6LOH5Zu65a6a5pS255uK5LiA6Iis5YK15Yi45Z6LLEFDMjEu6Leo5ZyL5oqV6LOH5Zu65a6a5pS255uK5LiA6Iis5YK15Yi45Z6LHUFDMjIu6YeR6J6N6LOH55Si6K2J5Yi45YyW5Z6LF0FDMjMu6auY5pS255uK5YK15Yi45Z6LIkFEMS7lnIvlhafmipXos4fosqjluaPluILloLTln7rph5EiQUQyLui3qOWci+aKleizh+iyqOW5o+W4guWgtOWfuumHkRlBRTEu5ZyL5YWn5oqV6LOH57WE5ZCI5Z6LJEFFMjEu6Leo5ZyL5oqV6LOH57WE5ZCI5Z6LX+iCoeelqOWeiyRBRTIyLui3qOWci+aKleizh+e1hOWQiOWei1/lgrXliLjlnoskQUUyMy7ot6jlnIvmipXos4fntYTlkIjlnotf5bmz6KGh5Z6LIUFFMjQu6Leo5ZyL5oqV6LOH57WE5ZCI5Z6LX+WFtuS7lgxBRi7kv53mnKzlnosYQUcu5LiN5YuV55Si6K2J5Yi45YyW5Z6LKkFIMTEu5ZyL5YWn5oqV6LOH5oyH5pW46IKh56Wo5Z6LX+iCoeelqOWeiypBSDEyLuWci+WFp+aKleizh+aMh+aVuOiCoeelqOWei1/lgrXliLjlnos0QUgxMy7lnIvlhafmipXos4fmjIfmlbjogqHnpajlnotf5qeT5qG/5Z6LL+WPjeWQkeWeiydBSDE0LuWci+WFp+aKleizh+aMh+aVuOiCoeelqOWei1/lhbbku5YqQUgyMS7ot6jlnIvmipXos4fmjIfmlbjogqHnpajlnotf6IKh56Wo5Z6LKkFIMjIu6Leo5ZyL5oqV6LOH5oyH5pW46IKh56Wo5Z6LX+WCteWIuOWeiztBSDIzLui3qOWci+aKleizh+aMh+aVuOiCoeelqOWei1/mp5Pmob/lnosv5Y+N5ZCR5Z6LX+iCoeelqDtBSDI0Lui3qOWci+aKleizh+aMh+aVuOiCoeelqOWei1/mp5Pmob/lnosv5Y+N5ZCR5Z6LX+WCteWIuDpBSDI1Lui3qOWci+aKleizh+aMh+aVuOiCoeelqOWei1/kuI3li5XnlKLorYnliLjljJYv5YW25LuWGUFJMS7lnIvlhafmipXos4fmjIfmlbjlnosZQUkyLui3qOWci+aKleizh+aMh+aVuOWeix9BSjEu5ZyL5YWn5oqV6LOH5aSa6YeN6LOH55Si5Z6LH0FKMi7ot6jlnIvmipXos4flpJrph43os4fnlKLlnosZQUsxLuWci+WFp0VURumAo+e1kOWfuumHkRUhAANBQTEDQUEyA0FCMQNBQjIEQUMxMQRBQzEyBEFDMjEEQUMyMgRBQzIzA0FEMQNBRDIDQUUxBEFFMjEEQUUyMgRBRTIzBEFFMjQCQUYCQUcEQUgxMQRBSDEyBEFIMTMEQUgxNARBSDIxBEFIMjIEQUgyMwRBSDI0BEFIMjUDQUkxA0FJMgNBSjEDQUoyA0FLMRQrAyFnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2cWAWZkAgUPFgIfAAUv6YeO5p2R5oqV5L+hLCDos4fmlpnku43ku6XoqbLlhazlj7jlhazlkYrngrrmupZkAgcPFgIfAGVkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYFBSFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHJiQ29taWQFIWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkcmJDbGFzcwUhY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyMSRyYkNsYXNzBSFjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIxJHJiQ29tQ0wFIWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkcmJDb21DTGwIY9labU8rSTz7KU7IVoaJ78qqHzw+jHEbNGoXVqEA'
event_validation = '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'
pre_save = [] # Temporary save before create a row
data_to_df = [] # Final result as a list of list
start_to_save = False # A switch for getting data if it's 野村美利堅高收益債基金
count = 0 # Download 10 unit data then break loop

# Get data settings
data = {
    '__VIEWSTATE' : view_state,
    '__VIEWSTATEGENERATOR' : 'C0A743AB',
    '__EVENTVALIDATION' : event_validation,
    'ctl00$ContentPlaceHolder1$ddlQ_YM': DATE,
    'ctl00$ContentPlaceHolder1$rdo1': 'rbComCL',
    'ctl00$ContentPlaceHolder1$ddlQ_Comid1' : 'A0032', # Set as Nomura
    'ctl00$ContentPlaceHolder1$ddlQ_Class1' : 'AC23',
    'ctl00$ContentPlaceHolder1$BtnExport' : '匯出'
}

# Start to request
url = 'https://www.sitca.org.tw/ROC/Industry/IN2629.aspx'
res = requests.post(url,data = data)

# Clear tag after decode
soup = bs(res.content.decode(),'html.parser') 

# Find tag by multiple class name
raw_data = soup.find_all('td',{ 'class' : ['DTeven','DTodd'] })

# Start to clear and get data
for data in raw_data:
    if start_to_save: # bool
        pre_save.append(data.string)
        if len(pre_save) == 9: # fulfilled condition of a rows
            data_to_df.append(pre_save)
            pre_save = [] # Reset temp data
            count+=1
        if count == 10: # Break if get all data
            break
    if data.string == '野村美利堅高收益債基金': # Turn on switch for saving data
        start_to_save = True

# Create dataframe with rows and columns
columns = ['no','t_type','bloomberg_code','t_name','amount','guarentee_institution','s-order_bonds','num_beneficiary_unit','net_ass_val_rate']
df_inv_target = pd.DataFrame(data_to_df, columns = columns)

# Get the share code
df_inv_target['t_name'] = df_inv_target['t_name'].apply(lambda x : x.split(' ')[0])

# Drop the unused coloumns
df_inv_target = df_inv_target['t_name']

# Print dataframe
df_inv_target